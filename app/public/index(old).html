<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style/normalize.css">
    <link rel="stylesheet" href="style/index.css">
    <title>Stylish</title>
</head>

<body>
    <header id="nav">
        <nav>
            <div id="left-nav">
                <div id="logo">
                    <img src="img/btn-logo-01.svg" class="btn_logo01">
                </div>
                <div id="type">
                    <ul>
                        <li class="left-nav-text" id="women">女裝</li>
                        <li class="left-nav-bar">|</li>
                        <li class="left-nav-text">男裝</li>
                        <li class="left-nav-bar">|</li>
                        <li class="left-nav-text">配件</li>
                    </ul>
                </div>
            </div>
            <div id="right-nav">
                <div id="search-bar">
                    <div class="Combined-Shape">
                    </div>
                    <img src="" alt="" id="magnifier">
                </div>
                <img src="img/btn-shopping-cart-01-add.svg" class="btn_shopping-cart01_add">
                <img src="img/btn-member-01-normal.svg" class="btn_member01_normal">
            </div>
        </nav>
        <div id="black"></div>
        <div id="banner">
            <div id="banner-text">
                <p>於是</p>
                <p>我也想要給你</p>
                <p>一個那麼美好的自己。</p>
                <p id="small">不朽《與自己和好如初》</p>
            </div>
        </div>
    </header>
    <div id="main">
        <div id="products-div">
            <div id="product0" class="product">
                <div class="product-pic">
                    <a href="" id="product-link-0">
                        <img src="" alt="" id="product-pic0">
                    </a>
                </div>
                <div id="color-0" class="color-parent"></div>
                <div id="product-text0">
                </div>
            </div>
            <div id="product1" class="product">
                <div class="product-pic">
                    <a href="" id="product-link-1">
                    <img src="" alt="" id="product-pic1">
                    </a>
                </div>
                <div id="color-1" class="color-parent"></div>
                <div id="product-text1">
                </div>
            </div>
            <div id="product2" class="product">
                <div class="product-pic">
                    <a href="" id="product-link-2">
                    <img src="" alt="" id="product-pic2">
                    </a>
                </div>
                <div id="color-2" class="color-parent"></div>
                <div id="product-text2">
                </div>
            </div>
            <div id="product3" class="product">
                <div class="product-pic">
                    <a href="" id="product-link-3">
                    <img src="" alt="" id="product-pic3">
                    </a>
                </div>
                <div id="color-3" class="color-parent"></div>
                <div id="product-text3">
                </div>
            </div>
            <div id="product4" class="product">
                <div class="product-pic">
                    <a href="" id="product-link-4">
                    <img src="" alt="" id="product-pic4">
                    </a>
                </div>
                <div id="color-4" class="color-parent"></div>
                <div id="product-text4">
                </div>
            </div>
            <div id="product5" class="product">
                <div class="product-pic">
                    <a href="" id="product-link-5">
                    <img src="" alt="" id="product-pic5">
                    </a>
                </div>
                <div id="color-5" class="color-parent"></div>
                <div id="product-text5">
                </div>
            </div>
        </div>
    </div>
    <footer id="footer">
        <div id="footer-70">
            <div id="left-footer">
                <ul>
                    <li class="-Stylish">關於 Stylish</li>
                    <li class="footer-bar">|</li>
                    <li class="footer-text">服務條款</li>
                    <li class="footer-bar">|</li>
                    <li class="footer-text">隱私政策</li>
                    <li class="footer-bar">|</li>
                    <li class="footer-text">聯絡我們</li>
                    <li class="footer-bar">|</li>
                    <li class="footer-text">FAQ</li>
                </ul>
            </div>
            <div id="right-footer">
                <div id="icons">
                    <img src="img/btn-line-01-normal.svg" class="btn_line01_normal icons">
                    <img src="img/btn-twitter-01-normal.svg" class="btn_twitter01_normal icons">
                    <img src="img/btn-facebook-01-normal.svg" class="btn_facebook01_normal icons">
                </div>
                <span id="copy-right">&copy; 2018. All rights reserved.</span>
            </div>
        </div>
    </footer>
    <script>
        // When get request arrive, call product API and get info
        // Make product request
        let checkoutRequest = new XMLHttpRequest();
        checkoutRequest.open("GET", "/api/V1.0/products/all", true);

        checkoutRequest.onload = function (sendback) {
            // 请求结束后,在此处写处理代码 
            const sendbackJSON = JSON.parse(sendback.target.response);
            console.log(sendbackJSON);

            // Put info into page
            for (let i =0 ; i < document.getElementsByClassName('product').length; i++) {
                
                // Put img and link url
                const productPic = document.getElementById(`product-pic${i}`);
                productPic.src = sendbackJSON.data[i].main_image;
                const productLink = document.getElementById(`product-link-${i}`);
                productLink.href = `http://3.134.125.243/product.html?id=${sendbackJSON.data[i].id}`;
                
                // Put colors
                const colorParentNode = document.getElementById(`color-${i}`)
                for (let j = 0; j < sendbackJSON.data[i].colors.length; j++) {
                    const newColorNode = document.createElement('div');
                    newColorNode.className = 'color';
                    newColorNode.style.backgroundColor = `${sendbackJSON.data[i].colors[j].code}`
                    colorParentNode.appendChild(newColorNode); 
                }

                // Put content text
                const textDiv = document.getElementById(`product-text${i}`)
                // Text
                const textNode = document.createElement('p');
                const textContent = document.createTextNode(`${sendbackJSON.data[i].title}`); 
                textNode.appendChild(textContent);
                textDiv.appendChild(textNode);
                // Price
                const pirceNode = document.createElement('p');
                const pirceContent = document.createTextNode(`TWD. ${sendbackJSON.data[i].price}`); 
                pirceNode.appendChild(pirceContent);
                textDiv.appendChild(pirceNode);
            }
        };
        checkoutRequest.send();


    </script>
</body>

</html>